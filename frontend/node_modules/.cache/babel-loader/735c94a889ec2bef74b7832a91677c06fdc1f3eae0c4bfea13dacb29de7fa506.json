{"ast":null,"code":"var _jsxFileName = \"/Users/igorfesenko/Desktop/xray-editor/src/ImageViewer/ImageViewer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './ImageViewer.css';\nimport SideToolbar from '../SideToolbar/SideToolbar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ImageViewer({\n  image,\n  onClose\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  const [brightness, setBrightness] = useState(100);\n  const [contrast, setContrast] = useState(100);\n  const [scale, setScale] = useState(1);\n  const [positionX, setPositionX] = useState(0);\n  const [positionY, setPositionY] = useState(0);\n  useEffect(() => {\n    if (!image) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const img = new Image();\n    img.onload = () => {\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0);\n      applyFilters(ctx);\n    };\n    img.src = URL.createObjectURL(image);\n  }, [image]);\n  const applyFilters = ctx => {\n    if (!ctx) return;\n    const imageData = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\n    const data = imageData.data;\n    const factorBrightness = (brightness + 100) / 100; // Convert brightness to a factor\n    const factorContrast = (contrast + 100) / 100; // Convert contrast to a factor\n\n    for (let i = 0; i < data.length; i += 4) {\n      // Apply brightness and contrast adjustment to each pixel\n      data[i] = factorContrast * (data[i] - 128) + 128 + brightness;\n      data[i + 1] = factorContrast * (data[i + 1] - 128) + 128 + brightness;\n      data[i + 2] = factorContrast * (data[i + 2] - 128) + 128 + brightness;\n    }\n    ctx.putImageData(imageData, 0, 0);\n  };\n  const handleBrightnessChange = value => {\n    setBrightness(value);\n    applyFilters(canvasRef.current.getContext('2d'));\n  };\n  const handleContrastChange = value => {\n    setContrast(value);\n    applyFilters(canvasRef.current.getContext('2d'));\n  };\n  const handleSave = () => {\n    const canvas = canvasRef.current;\n    const modifiedImage = canvas.toDataURL();\n    onClose(modifiedImage);\n  };\n  const handleZoomIn = () => {\n    setScale(scale + 0.1);\n  };\n  const handleZoomOut = () => {\n    if (scale > 0.1) {\n      setScale(scale - 0.1);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"image-viewer\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleZoomIn,\n        children: \"Zoom In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleZoomOut,\n        children: \"Zoom Out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      className: \"canvas\",\n      style: {\n        transform: `scale(${scale}) translate(${positionX}px, ${positionY}px)`,\n        cursor: 'grab'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SideToolbar, {\n      onBrightnessChange: handleBrightnessChange,\n      onContrastChange: handleContrastChange,\n      onSave: handleSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n}\n_s(ImageViewer, \"z8R+V8GvffQIB7oVxMU3bnMi8pk=\");\n_c = ImageViewer;\nexport default ImageViewer;\nvar _c;\n$RefreshReg$(_c, \"ImageViewer\");","map":{"version":3,"names":["React","useState","useEffect","useRef","SideToolbar","jsxDEV","_jsxDEV","ImageViewer","image","onClose","_s","canvasRef","brightness","setBrightness","contrast","setContrast","scale","setScale","positionX","setPositionX","positionY","setPositionY","canvas","current","ctx","getContext","img","Image","onload","width","height","drawImage","applyFilters","src","URL","createObjectURL","imageData","getImageData","data","factorBrightness","factorContrast","i","length","putImageData","handleBrightnessChange","value","handleContrastChange","handleSave","modifiedImage","toDataURL","handleZoomIn","handleZoomOut","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","style","transform","cursor","onBrightnessChange","onContrastChange","onSave","_c","$RefreshReg$"],"sources":["/Users/igorfesenko/Desktop/xray-editor/src/ImageViewer/ImageViewer.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport './ImageViewer.css';\nimport SideToolbar from '../SideToolbar/SideToolbar';\n\nfunction ImageViewer({ image, onClose }) {\n    const canvasRef = useRef(null);\n    const [brightness, setBrightness] = useState(100);\n    const [contrast, setContrast] = useState(100);\n    const [scale, setScale] = useState(1);\n    const [positionX, setPositionX] = useState(0);\n    const [positionY, setPositionY] = useState(0);\n\n    useEffect(() => {\n        if (!image) return;\n\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext('2d');\n\n        const img = new Image();\n        img.onload = () => {\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n            applyFilters(ctx);\n        };\n        img.src = URL.createObjectURL(image);\n    }, [image]);\n\n    const applyFilters = (ctx) => {\n        if (!ctx) return;\n\n        const imageData = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\n        const data = imageData.data;\n\n        const factorBrightness = (brightness + 100) / 100; // Convert brightness to a factor\n        const factorContrast = (contrast + 100) / 100; // Convert contrast to a factor\n\n        for (let i = 0; i < data.length; i += 4) {\n            // Apply brightness and contrast adjustment to each pixel\n            data[i] = factorContrast * (data[i] - 128) + 128 + brightness;\n            data[i + 1] = factorContrast * (data[i + 1] - 128) + 128 + brightness;\n            data[i + 2] = factorContrast * (data[i + 2] - 128) + 128 + brightness;\n        }\n\n        ctx.putImageData(imageData, 0, 0);\n    };\n\n    const handleBrightnessChange = (value) => {\n        setBrightness(value);\n        applyFilters(canvasRef.current.getContext('2d'));\n    };\n\n    const handleContrastChange = (value) => {\n        setContrast(value);\n        applyFilters(canvasRef.current.getContext('2d'));\n    };\n\n    const handleSave = () => {\n        const canvas = canvasRef.current;\n        const modifiedImage = canvas.toDataURL();\n        onClose(modifiedImage);\n    };\n\n    const handleZoomIn = () => {\n        setScale(scale + 0.1);\n    };\n\n    const handleZoomOut = () => {\n        if (scale > 0.1) {\n            setScale(scale - 0.1);\n        }\n    };\n\n    return (\n        <div className=\"image-viewer\">\n            <div className=\"controls\">\n                <button onClick={handleZoomIn}>Zoom In</button>\n                <button onClick={handleZoomOut}>Zoom Out</button>\n                <button onClick={onClose}>Close</button>\n            </div>\n            <canvas\n                ref={canvasRef}\n                className=\"canvas\"\n                style={{\n                    transform: `scale(${scale}) translate(${positionX}px, ${positionY}px)`,\n                    cursor: 'grab',\n                }}\n            />\n            <SideToolbar\n                onBrightnessChange={handleBrightnessChange}\n                onContrastChange={handleContrastChange}\n                onSave={handleSave}\n            />\n        </div>\n    );\n}\n\nexport default ImageViewer;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAO,mBAAmB;AAC1B,OAAOC,WAAW,MAAM,4BAA4B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErD,SAASC,WAAWA,CAAC;EAAEC,KAAK;EAAEC;AAAQ,CAAC,EAAE;EAAAC,EAAA;EACrC,MAAMC,SAAS,GAAGR,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM,CAACS,UAAU,EAAEC,aAAa,CAAC,GAAGZ,QAAQ,CAAC,GAAG,CAAC;EACjD,MAAM,CAACa,QAAQ,EAAEC,WAAW,CAAC,GAAGd,QAAQ,CAAC,GAAG,CAAC;EAC7C,MAAM,CAACe,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,CAAC,CAAC;EACrC,MAAM,CAACiB,SAAS,EAAEC,YAAY,CAAC,GAAGlB,QAAQ,CAAC,CAAC,CAAC;EAC7C,MAAM,CAACmB,SAAS,EAAEC,YAAY,CAAC,GAAGpB,QAAQ,CAAC,CAAC,CAAC;EAE7CC,SAAS,CAAC,MAAM;IACZ,IAAI,CAACM,KAAK,EAAE;IAEZ,MAAMc,MAAM,GAAGX,SAAS,CAACY,OAAO;IAChC,MAAMC,GAAG,GAAGF,MAAM,CAACG,UAAU,CAAC,IAAI,CAAC;IAEnC,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAAC,CAAC;IACvBD,GAAG,CAACE,MAAM,GAAG,MAAM;MACfN,MAAM,CAACO,KAAK,GAAGH,GAAG,CAACG,KAAK;MACxBP,MAAM,CAACQ,MAAM,GAAGJ,GAAG,CAACI,MAAM;MAC1BN,GAAG,CAACO,SAAS,CAACL,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;MACxBM,YAAY,CAACR,GAAG,CAAC;IACrB,CAAC;IACDE,GAAG,CAACO,GAAG,GAAGC,GAAG,CAACC,eAAe,CAAC3B,KAAK,CAAC;EACxC,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;EAEX,MAAMwB,YAAY,GAAIR,GAAG,IAAK;IAC1B,IAAI,CAACA,GAAG,EAAE;IAEV,MAAMY,SAAS,GAAGZ,GAAG,CAACa,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE1B,SAAS,CAACY,OAAO,CAACM,KAAK,EAAElB,SAAS,CAACY,OAAO,CAACO,MAAM,CAAC;IAC3F,MAAMQ,IAAI,GAAGF,SAAS,CAACE,IAAI;IAE3B,MAAMC,gBAAgB,GAAG,CAAC3B,UAAU,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;IACnD,MAAM4B,cAAc,GAAG,CAAC1B,QAAQ,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;;IAE/C,KAAK,IAAI2B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,CAACI,MAAM,EAAED,CAAC,IAAI,CAAC,EAAE;MACrC;MACAH,IAAI,CAACG,CAAC,CAAC,GAAGD,cAAc,IAAIF,IAAI,CAACG,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG7B,UAAU;MAC7D0B,IAAI,CAACG,CAAC,GAAG,CAAC,CAAC,GAAGD,cAAc,IAAIF,IAAI,CAACG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG7B,UAAU;MACrE0B,IAAI,CAACG,CAAC,GAAG,CAAC,CAAC,GAAGD,cAAc,IAAIF,IAAI,CAACG,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG7B,UAAU;IACzE;IAEAY,GAAG,CAACmB,YAAY,CAACP,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC;EACrC,CAAC;EAED,MAAMQ,sBAAsB,GAAIC,KAAK,IAAK;IACtChC,aAAa,CAACgC,KAAK,CAAC;IACpBb,YAAY,CAACrB,SAAS,CAACY,OAAO,CAACE,UAAU,CAAC,IAAI,CAAC,CAAC;EACpD,CAAC;EAED,MAAMqB,oBAAoB,GAAID,KAAK,IAAK;IACpC9B,WAAW,CAAC8B,KAAK,CAAC;IAClBb,YAAY,CAACrB,SAAS,CAACY,OAAO,CAACE,UAAU,CAAC,IAAI,CAAC,CAAC;EACpD,CAAC;EAED,MAAMsB,UAAU,GAAGA,CAAA,KAAM;IACrB,MAAMzB,MAAM,GAAGX,SAAS,CAACY,OAAO;IAChC,MAAMyB,aAAa,GAAG1B,MAAM,CAAC2B,SAAS,CAAC,CAAC;IACxCxC,OAAO,CAACuC,aAAa,CAAC;EAC1B,CAAC;EAED,MAAME,YAAY,GAAGA,CAAA,KAAM;IACvBjC,QAAQ,CAACD,KAAK,GAAG,GAAG,CAAC;EACzB,CAAC;EAED,MAAMmC,aAAa,GAAGA,CAAA,KAAM;IACxB,IAAInC,KAAK,GAAG,GAAG,EAAE;MACbC,QAAQ,CAACD,KAAK,GAAG,GAAG,CAAC;IACzB;EACJ,CAAC;EAED,oBACIV,OAAA;IAAK8C,SAAS,EAAC,cAAc;IAAAC,QAAA,gBACzB/C,OAAA;MAAK8C,SAAS,EAAC,UAAU;MAAAC,QAAA,gBACrB/C,OAAA;QAAQgD,OAAO,EAAEJ,YAAa;QAAAG,QAAA,EAAC;MAAO;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eAC/CpD,OAAA;QAAQgD,OAAO,EAAEH,aAAc;QAAAE,QAAA,EAAC;MAAQ;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACjDpD,OAAA;QAAQgD,OAAO,EAAE7C,OAAQ;QAAA4C,QAAA,EAAC;MAAK;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvC,CAAC,eACNpD,OAAA;MACIqD,GAAG,EAAEhD,SAAU;MACfyC,SAAS,EAAC,QAAQ;MAClBQ,KAAK,EAAE;QACHC,SAAS,EAAG,SAAQ7C,KAAM,eAAcE,SAAU,OAAME,SAAU,KAAI;QACtE0C,MAAM,EAAE;MACZ;IAAE;MAAAP,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eACFpD,OAAA,CAACF,WAAW;MACR2D,kBAAkB,EAAEnB,sBAAuB;MAC3CoB,gBAAgB,EAAElB,oBAAqB;MACvCmB,MAAM,EAAElB;IAAW;MAAAQ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtB,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEd;AAAChD,EAAA,CA3FQH,WAAW;AAAA2D,EAAA,GAAX3D,WAAW;AA6FpB,eAAeA,WAAW;AAAC,IAAA2D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}