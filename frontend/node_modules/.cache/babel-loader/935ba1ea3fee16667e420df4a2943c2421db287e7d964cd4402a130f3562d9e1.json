{"ast":null,"code":"var _jsxFileName = \"/Users/igorfesenko/Desktop/xray-editor/src/ImageViewer/ImageViewer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './ImageViewer.css';\nimport SideToolbar from '../SideToolbar/SideToolbar';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ImageViewer({\n  image,\n  onClose\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  const [brightness, setBrightness] = useState(100);\n  const [contrast, setContrast] = useState(100);\n  useEffect(() => {\n    if (!image) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const img = new Image();\n    img.onload = () => {\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0);\n      applyFilters(ctx);\n    };\n    img.src = URL.createObjectURL(image);\n  }, [image]);\n  const applyFilters = ctx => {\n    if (!ctx) return;\n    const imageData = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\n    const data = imageData.data;\n    const factorBrightness = (brightness + 100) / 100; // Convert brightness to a factor\n    const factorContrast = (contrast + 100) / 100; // Convert contrast to a factor\n\n    for (let i = 0; i < data.length; i += 4) {\n      // Apply brightness and contrast adjustment to each pixel\n      data[i] = factorContrast * (data[i] - 128) + 128 + brightness;\n      data[i + 1] = factorContrast * (data[i + 1] - 128) + 128 + brightness;\n      data[i + 2] = factorContrast * (data[i + 2] - 128) + 128 + brightness;\n    }\n    ctx.putImageData(imageData, 0, 0);\n  };\n  const handleBrightnessChange = value => {\n    setBrightness(value);\n    applyFilters(canvasRef.current.getContext('2d'));\n  };\n  const handleContrastChange = value => {\n    setContrast(value);\n    applyFilters(canvasRef.current.getContext('2d'));\n  };\n  const handleSave = () => {\n    const canvas = canvasRef.current;\n    const modifiedImage = canvas.toDataURL();\n    onClose(modifiedImage);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"image-viewer\",\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      className: \"canvas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SideToolbar, {\n      onBrightnessChange: handleBrightnessChange,\n      onContrastChange: handleContrastChange,\n      onSave: handleSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 9\n  }, this);\n}\n_s(ImageViewer, \"ziWbqv2VuMI3rR92CzdKXKN04Ao=\");\n_c = ImageViewer;\nexport default ImageViewer;\nvar _c;\n$RefreshReg$(_c, \"ImageViewer\");","map":{"version":3,"names":["React","useState","useEffect","useRef","SideToolbar","jsxDEV","_jsxDEV","ImageViewer","image","onClose","_s","canvasRef","brightness","setBrightness","contrast","setContrast","canvas","current","ctx","getContext","img","Image","onload","width","height","drawImage","applyFilters","src","URL","createObjectURL","imageData","getImageData","data","factorBrightness","factorContrast","i","length","putImageData","handleBrightnessChange","value","handleContrastChange","handleSave","modifiedImage","toDataURL","className","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","onBrightnessChange","onContrastChange","onSave","_c","$RefreshReg$"],"sources":["/Users/igorfesenko/Desktop/xray-editor/src/ImageViewer/ImageViewer.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport './ImageViewer.css';\nimport SideToolbar from '../SideToolbar/SideToolbar';\n\nfunction ImageViewer({ image, onClose }) {\n    const canvasRef = useRef(null);\n    const [brightness, setBrightness] = useState(100);\n    const [contrast, setContrast] = useState(100);\n\n    useEffect(() => {\n        if (!image) return;\n\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext('2d');\n\n        const img = new Image();\n        img.onload = () => {\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n            applyFilters(ctx);\n        };\n        img.src = URL.createObjectURL(image);\n    }, [image]);\n\n    const applyFilters = (ctx) => {\n        if (!ctx) return;\n\n        const imageData = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\n        const data = imageData.data;\n\n        const factorBrightness = (brightness + 100) / 100; // Convert brightness to a factor\n        const factorContrast = (contrast + 100) / 100; // Convert contrast to a factor\n\n        for (let i = 0; i < data.length; i += 4) {\n            // Apply brightness and contrast adjustment to each pixel\n            data[i] = factorContrast * (data[i] - 128) + 128 + brightness;\n            data[i + 1] = factorContrast * (data[i + 1] - 128) + 128 + brightness;\n            data[i + 2] = factorContrast * (data[i + 2] - 128) + 128 + brightness;\n        }\n\n        ctx.putImageData(imageData, 0, 0);\n    };\n\n    const handleBrightnessChange = (value) => {\n        setBrightness(value);\n        applyFilters(canvasRef.current.getContext('2d'));\n    };\n\n    const handleContrastChange = (value) => {\n        setContrast(value);\n        applyFilters(canvasRef.current.getContext('2d'));\n    };\n\n    const handleSave = () => {\n        const canvas = canvasRef.current;\n        const modifiedImage = canvas.toDataURL();\n        onClose(modifiedImage);\n    };\n\n    return (\n        <div className=\"image-viewer\">\n            <canvas ref={canvasRef} className=\"canvas\" />\n            <SideToolbar\n                onBrightnessChange={handleBrightnessChange}\n                onContrastChange={handleContrastChange}\n                onSave={handleSave}\n            />\n        </div>\n    );\n}\n\nexport default ImageViewer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}